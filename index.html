<html>
  <head>

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.js"></script>
    <script src="https://unpkg.com/aframe-transparent-video-shader@1.0.6/dist/aframe-transparent-video-shader.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script>
      AFRAME.registerComponent('move', {
    init: function() {
      // wait until the model is loaded
      this.el.addEventListener("model-loaded", evt => {
        const mixer = new THREE.AnimationMixer(this.el.components['gltf-model'].model);
        const clips = this.el.components['gltf-model'].model.animations[0];
        mixer.clipAction(clips).play();
        // "expose" the animation mixer
        this.mixer = mixer;
      })
    },
    // on each render loop (actually before each render loop)
    tick: function(t, dt) {
      if (!this.mixer) return; // if the mixer exists
      this.mixer.update(dt / 1000) // update it with the delta time
    }
  })
      </script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.1.2/howler.core.min.js"></script>
    <script>


      document.addEventListener("DOMContentLoaded", function() {
	const sceneEl = document.querySelector('a-scene');
	let arSystem;
	sceneEl.addEventListener('loaded', function () {
	  arSystem = sceneEl.systems["mindar-image-system"];
    sceneEl.object3D.traverse((o) => {
    if (o.isMesh && o.material.map)  {
      o.material.map.encoding = THREE.sRGBEncoding;
      o.material.needsUpdate = true;
    }
  });
	});

  const aCanvas = document.getElementsByClassName("a-canvas")

  function startAR(){
  const header = document.getElementById('header')
  const canvas = document.getElementById('canvas')
  header.style.display = "none"
  // aCanvas.style.display = "block"
  arSystem.start()
}



const startButton = document.getElementById("startButton")
startButton.addEventListener('click', startAR)


	const target0 = document.querySelector('#target0');
	const target1 = document.querySelector('#target1');
	const target2 = document.querySelector('#target2');
	const target3 = document.querySelector('#target3');
	const target4 = document.querySelector('#target4');
	const target5 = document.querySelector('#target5');
	const target6 = document.querySelector('#target6');
	const target7 = document.querySelector('#target7');
	const target8 = document.querySelector('#target8');
	const target9 = document.querySelector('#target9');
	const target10 = document.querySelector('#target10');
	const target11 = document.querySelector('#target11');
	const target12 = document.querySelector('#target12');
	const target13 = document.querySelector('#target13');
	const target14 = document.querySelector('#target14');
	const target15 = document.querySelector('#target15');

	sceneEl.addEventListener("arReady", (event) => {
	  // console.log("MindAR is ready")
	});
	// arError event triggered when something went wrong. Mostly browser compatbility issue
	sceneEl.addEventListener("arError", (event) => {
	  // console.log("MindAR failed to start")
	});
	// detect target found
  var audio0 = new Howl({ src: ["/public/0.mp3"]})
	target0.addEventListener("targetFound", event => {
  audio0.play();
  });
	target0.addEventListener("targetLost", event => {
    audio0.pause()
	});


  

  var audio3 = new Howl({ src: ["/public/3.mp3"]})
	target3.addEventListener("targetFound", event => {
  audio3.play();
  });
	target3.addEventListener("targetLost", event => {
    audio3.pause()
	});
  



  var audio2 = new Howl({ src: ["/public/2.mp3"]})
	target2.addEventListener("targetFound", event => {
  audio2.play();
  });
	target2.addEventListener("targetLost", event => {
    audio2.pause()
	});

 

  var audio4 = new Howl({ src: ["/public/4.mp3"]})
	target4.addEventListener("targetFound", event => {
  audio4.play();
  });
	target3.addEventListener("targetLost", event => {
    audio3.pause()
	});

 

  var audio4 = new Howl({ src: ["/public/4.mp3"]})
	target4.addEventListener("targetFound", event => {
  audio4.play();
  });
	target4.addEventListener("targetLost", event => {
    audio4.pause()
	});

  var audio5 = new Howl({ src: ["/public/5.mp3"]})
	target5.addEventListener("targetFound", event => {
  audio5.play();
  });
	target5.addEventListener("targetLost", event => {
    audio5.pause()
	});

  var audio6 = new Howl({ src: ["/public/6.mp3"]})
	target6.addEventListener("targetFound", event => {
  audio6.play();
  });
	target6.addEventListener("targetLost", event => {
    audio6.pause()
	});

  var audio7 = new Howl({ src: ["/public/7.mp3"]})
	target7.addEventListener("targetFound", event => {
  audio7.play();
  });
	target7.addEventListener("targetLost", event => {
    audio7.pause()
	});

  var audio8 = new Howl({ src: ["/public/8.mp3"]})
	target8.addEventListener("targetFound", event => {
  audio8.play();
  });
	target8.addEventListener("targetLost", event => {
    audio8.pause()
	});

  var audio9 = new Howl({ src: ["/public/9.mp3"]})
	target9.addEventListener("targetFound", event => {
  audio9.play();
  });
	target9.addEventListener("targetLost", event => {
    audio9.pause()
	});

  var audio10 = new Howl({src: ['/public/10.mp3']});
	target10.addEventListener("targetFound", event => {
  audio10.play();
  });
	target10.addEventListener("targetLost", event => {
    audio10.pause()
	});

  var audio11 = new Howl({src: ['/public/11.mp3']});
	target11.addEventListener("targetFound", event => {
  audio11.play();
  });
	target11.addEventListener("targetLost", event => {
    audio11.pause()
	});

  var audio12 = new Howl({src: ['/public/12.mp3']});
	target12.addEventListener("targetFound", event => {
  audio12.play();
  });
	target12.addEventListener("targetLost", event => {
    audio12.pause()
	});

  var audio13 = new Howl({src: ['/public/13.mp3']});
	target13.addEventListener("targetFound", event => {
  audio13.play();
  });
	target13.addEventListener("targetLost", event => {
    audio13.pause()
	});

  var audio14 = new Howl({src: ['/public/14.mp3']});
	target14.addEventListener("targetFound", event => {
  audio14.play();
  });
	target14.addEventListener("targetLost", event => {
    audio14.pause()
	});

  var audio15 = new Howl({src: ['/public/15.mp3']});
	target15.addEventListener("targetFound", event => {
  audio15.play();
  });
	target15.addEventListener("targetLost", event => {
    audio15.pause()
	});

      });
    </script>
      <style>
      
        body {
    margin: 0;
      font-family: "sofia-pro", Futura, sans-serif;
      }
        #container {
        
    width: 100vw;
    height: 100vh;
    position: relative;
    overflow: hidden;
        }
        #control {
    position: fixed;
    top: 0;
    left: 0;
    z-index: 2;
        }
      .header-box{
        background-position: center;
        background-image: url("/public/MXT_CLM_Kickstarter_Title_MJ_03.gif");
        background-size:contain;
        background-repeat: no-repeat;
        width: 75vw;
        height: 200px;
      }
      .canvas{
        display: none;
      }
      .a-canvas{
        z-index: -1;
      }
      .header {
        font-size: 36px;
        font-weight: 700;
      }
      .flex{
        justify-content: center;
        align-items: center;
        display: flex;
        flex-direction: column;
        height: 100vh;
      }
      .button{
        font-size: 36px;
        border: 0px dashed black;
    background-color: white;
    color: black;
    padding: 14px 28px;
    cursor: pointer;
      }
      .button:hover{
        border-color: orange;
        color: orange;
      }
      
      </style>
  </head>
  <body>
    <div
        class="flex"
        id="header"
        style="display: flex;"
      >
        <div class="header-box"></div>
        <div>
          <button  class="button" id="startButton">
            Start
          </button>
        </div>
        <div></div>
      </div>
     
    <a-scene renderer="antialias: true;
    colorManagement: false;" mindar-image="autoStart: false; imageTargetSrc: ./targets.mind; filterMinCF:0.00025; filterBeta: 0.0008" color-space="sRGB" renderer="colorManagement: true, physicallyCorrectLights" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false">
      <a-assets>
        <!-- <a-asset-item id="0" src="/public/0_anim.gltf"></a-asset-item> -->
        <a-asset-item id="1" src="/public/1.gltf"></a-asset-item>
        <a-asset-item id="2" src="/public/2.gltf"></a-asset-item>
        <a-asset-item id="3" src="/public/3.gltf"></a-asset-item>
        <a-asset-item id="4" src="/public/4.gltf"></a-asset-item>
        <a-asset-item id="5" src="/public/5.gltf"></a-asset-item>
        <a-asset-item id="6" src="/public/6.gltf"></a-asset-item>
        <a-asset-item id="7" src="/public/7.gltf"></a-asset-item>
        <a-asset-item id="8" src="/public/8.gltf"></a-asset-item>
        <a-asset-item id="9" src="/public/9.gltf"></a-asset-item>
        <a-asset-item id="10" src="/public/10.gltf"></a-asset-item>
        <a-asset-item id="11" src="/public/11.gltf"></a-asset-item>
        <a-asset-item id="12" src="/public/12.gltf"></a-asset-item>
        <a-asset-item id="13" src="/public/13.gltf"></a-asset-item>
        <a-asset-item id="14" src="/public/14.gltf"></a-asset-item>
        <a-asset-item id="15" src="/public/15.gltf"></a-asset-item>
        <!-- <audio id="audio0" src="/public/0.mp3" preload="auto"></audio> -->
        
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <a-entity id="target0" mindar-image-target="targetIndex: 0">

          <a-entity rotation="90 0 0" gltf-model="/public/0a.gltf" move position="0 -.1 0" scale="3.5 3.5 3.5"></a-entity>                     
          <a-entity rotation="90 0 0" gltf-model="/public/0b.gltf" move position="-0.35 -.1 0" scale="3.5 3.5 3.5"></a-entity>                     
          <a-entity rotation="90 0 0" gltf-model="/public/0e.gltf" move position="-0.2 .15 0" scale="3.5 3.5 3.5"></a-entity>                     
          <a-entity rotation="90 0 0" gltf-model="/public/0c.gltf" move position="0.2 .15 0" scale="3.5 3.5 3.5"></a-entity>                     
          <a-entity rotation="90 0 0" gltf-model="/public/0d.gltf" move position="0.35 -.15 0" scale="3.5 3.5 3.5"></a-entity>                     
        </a-entity>



  <a-entity id="target2" mindar-image-target="targetIndex: 2" >
    <a-entity rotation="90 0 0" position="0.1 0 0" gltf-model="#2" scale="3.5 3.5 3.5"></a-entity>
  </a-entity>

<a-entity id="target3" mindar-image-target="targetIndex: 3" >
  <a-entity rotation="-90 0 0" position="-.05 .1 .05" gltf-model="/public/3.gltf" scale="3.5 3.5 3.5"></a-entity>
</a-entity>



<a-entity id="target4" mindar-image-target="targetIndex: 4">
  <a-entity rotation="90 0 0" position="0 0 0" gltf-model="/public/4.gltf" scale="30 30 30">
  </a-entity>

</a-entity>

<a-entity id="target5" mindar-image-target="targetIndex: 5">
  <!-- <a-entity rotation="90 0 0" gltf-model="#7" scale="0.25 0.25 0.25"></a-entity> -->

  <a-entity rotation="90 0 0" position="0 0 0" gltf-model="/public/5.gltf" scale="30 30 30"></a-entity>

</a-entity>


<a-entity id="target6" mindar-image-target="targetIndex: 6">
  <a-entity rotation="90 0 0" position="0 0 0" gltf-model="/public/6.gltf" scale="10 10 10"></a-entity>
  
</a-entity>

<a-entity id="target7" mindar-image-target="targetIndex: 7">
  <a-entity rotation="90 0 0" gltf-model="#7" scale="10 10 10"></a-entity>
</a-entity>

<a-entity id="target8" mindar-image-target="targetIndex: 8">
  <a-entity rotation="90 0 0" gltf-model="#8" scale="20 20 20"></a-entity>
</a-entity>

<a-entity id="target9" mindar-image-target="targetIndex: 9">
  <a-entity rotation="90 0 0" gltf-model="#9" scale="10 10 10"></a-entity>
</a-entity>

<a-entity id="target10" mindar-image-target="targetIndex: 10">
  <a-entity rotation="90 0 0" gltf-model="#10" scale="15 15 15"></a-entity>
</a-entity>

<a-entity id="target11" mindar-image-target="targetIndex: 11">
  <a-entity rotation="90 0 0" gltf-model="#11" scale="12 12 12"></a-entity>
</a-entity>

<a-entity id="target12" mindar-image-target="targetIndex: 12">
  <a-entity rotation="90 0 0" gltf-model="#12" scale="12 12 12"></a-entity>
</a-entity>

<a-entity id="target13" mindar-image-target="targetIndex: 13">
  <a-entity rotation="90 0 0" gltf-model="#13" scale="12 12 12"></a-entity>
</a-entity>

<a-entity id="target14" mindar-image-target="targetIndex: 14">
  <a-entity rotation="90 0 0" gltf-model="#14" postition="0 0 .3" scale="40 40 40"></a-entity>
</a-entity>

<a-entity id="target15" mindar-image-target="targetIndex: 15">
  <a-entity rotation="90 0 0" gltf-model="#15" scale="8 8 8"></a-entity>
</a-entity>


    </a-scene>

  </body>
</html>