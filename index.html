<html>
  <head>

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.js"></script>
    <script src="https://unpkg.com/aframe-transparent-video-shader@1.0.6/dist/aframe-transparent-video-shader.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.2.0/dist/aframe-extras.min.js"></script>
    <script>
      AFRAME.registerComponent('move', {
    init: function() {
      // wait until the model is loaded
      this.el.addEventListener("model-loaded", evt => {
        const mixer = new THREE.AnimationMixer(this.el.components['gltf-model'].model);
        const clips = this.el.components['gltf-model'].model.animations[0];
        mixer.clipAction(clips).play();
        // "expose" the animation mixer
        this.mixer = mixer;
      })
    },
    // on each render loop (actually before each render loop)
    tick: function(t, dt) {
      if (!this.mixer) return; // if the mixer exists
      this.mixer.update(dt / 1000) // update it with the delta time
    }
  })
      </script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.1.2/howler.core.min.js"></script>
    <script>


      document.addEventListener("DOMContentLoaded", function() {
	const sceneEl = document.querySelector('a-scene');
	let arSystem;
	sceneEl.addEventListener('loaded', function () {
	  arSystem = sceneEl.systems["mindar-image-system"];
    sceneEl.object3D.traverse((o) => {
    if (o.isMesh && o.material.map)  {
      o.material.map.encoding = THREE.sRGBEncoding;
      o.material.needsUpdate = true;
    }
  });
	});

  const aCanvas = document.getElementsByClassName("a-canvas")

  function startAR(){
  const header = document.getElementById('header')
  const canvas = document.getElementById('canvas')
  header.style.display = "none"
  // aCanvas.style.display = "block"
  arSystem.start()
}

const understandButton = document.getElementById("understandButton")
understandButton.addEventListener("click", toggleButtons)

const startButton = document.getElementById("startButton")
startButton.addEventListener('click', startAR)

const instructions = document.getElementById("instructions")

function toggleButtons(){understandButton.style.display = "none"
instructions.style.display = "none"
startButton.style.display = "block"}

	const target0 = document.querySelector('#target0');
	const target1 = document.querySelector('#target1');
	const target2 = document.querySelector('#target2');
	const target3 = document.querySelector('#target3');
	const target4 = document.querySelector('#target4');
	const target5 = document.querySelector('#target5');
	const target6 = document.querySelector('#target6');
	const target7 = document.querySelector('#target7');
	const target8 = document.querySelector('#target8');
	const target9 = document.querySelector('#target9');
	const target10 = document.querySelector('#target10');
	const target11 = document.querySelector('#target11');
	const target12 = document.querySelector('#target12');
	const target13 = document.querySelector('#target13');
	const target14 = document.querySelector('#target14');
	const target15 = document.querySelector('#target15');
	const target16 = document.querySelector('#target16');
	const target17 = document.querySelector('#target17');
	const target18 = document.querySelector('#target18');
	const target19 = document.querySelector('#target19');
	const target20 = document.querySelector('#target20');
	const target21 = document.querySelector('#target21');
	const target22 = document.querySelector('#target22');

	sceneEl.addEventListener("arReady", (event) => {
	  // console.log("MindAR is ready")
	});
	// arError event triggered when something went wrong. Mostly browser compatbility issue
	sceneEl.addEventListener("arError", (event) => {
	  // console.log("MindAR failed to start")
	});
	// detect target found
  var audio0 = new Howl({ src: ["/public/0.mp3"]})
	target0.addEventListener("targetFound", event => {
  audio0.play();
  });
	target0.addEventListener("targetLost", event => {
    audio0.pause()
	});

  // var audio1 = new Howl({ src: ["/public/0.mp3"]})
	// target1.addEventListener("targetFound", event => {
  // audio1.play();
  // });
	// target1.addEventListener("targetLost", event => {
  //   audio1.pause()
	// });


  

  // var audio3 = new Howl({ src: ["/public/3.mp3"]})
	// target3.addEventListener("targetFound", event => {
  // audio3.play();
  // });
	// target3.addEventListener("targetLost", event => {
  //   audio3.pause()
	// });
  



  var audio6 = new Howl({ src: ["/public/title.mp3"]})
	target6.addEventListener("targetFound", event => {
  audio6.play();
  });
	target6.addEventListener("targetLost", event => {
    audio6.pause()
	});

  var audio7 = new Howl({ src: ["/public/2.mp3"]})
	target7.addEventListener("targetFound", event => {
  audio7.play();
  });
	target7.addEventListener("targetLost", event => {
    audio7.pause()
	});

  var audio8 = new Howl({ src: ["/public/3.mp3"]})
	target8.addEventListener("targetFound", event => {
  audio8.play();
  });
	target8.addEventListener("targetLost", event => {
    audio8.pause()
	});

  var audio9 = new Howl({ src: ["/public/4.mp3"]})
	target9.addEventListener("targetFound", event => {
  audio9.play();
  });
	target9.addEventListener("targetLost", event => {
    audio9.pause()
	});

  var audio10 = new Howl({src: ['/public/5.mp3']});
	target10.addEventListener("targetFound", event => {
  audio10.play();
  });
	target10.addEventListener("targetLost", event => {
    audio10.pause()
	});

  var audio11 = new Howl({src: ['/public/6.mp3']});
	target11.addEventListener("targetFound", event => {
  audio11.play();
  });
	target11.addEventListener("targetLost", event => {
    audio11.pause()
	});

  var audio12 = new Howl({src: ['/public/7.mp3']});
	target12.addEventListener("targetFound", event => {
  audio12.play();
  });
	target12.addEventListener("targetLost", event => {
    audio12.pause()
	});

  var audio13 = new Howl({src: ['/public/8.mp3']});
	target13.addEventListener("targetFound", event => {
  audio13.play();
  });
	target13.addEventListener("targetLost", event => {
    audio13.pause()
	});

  var audio14 = new Howl({src: ['/public/9.mp3']});
	target14.addEventListener("targetFound", event => {
  audio14.play();
  });
	target14.addEventListener("targetLost", event => {
    audio14.pause()
	});

  var audio15 = new Howl({src: ['/public/10.mp3']});
	target15.addEventListener("targetFound", event => {
  audio15.play();
  });
	target15.addEventListener("targetLost", event => {
    audio15.pause()
	});
  var audio16 = new Howl({src: ['/public/11.mp3']});
	target16.addEventListener("targetFound", event => {
  audio16.play();
  });
	target16.addEventListener("targetLost", event => {
    audio16.pause()
	});
  var audio17 = new Howl({src: ['/public/12.mp3']});
	target17.addEventListener("targetFound", event => {
  audio17.play();
  });
	target17.addEventListener("targetLost", event => {
    audio17.pause()
	});
  var audio18 = new Howl({src: ['/public/13.mp3']});
	target18.addEventListener("targetFound", event => {
  audio18.play();
  });
	target18.addEventListener("targetLost", event => {
    audio18.pause()
	});
  var audio19 = new Howl({src: ['/public/14.mp3']});
	target19.addEventListener("targetFound", event => {
  audio19.play();
  });
	target19.addEventListener("targetLost", event => {
    audio19.pause()
	});
  var audio20 = new Howl({src: ['/public/15.mp3']});
	target20.addEventListener("targetFound", event => {
  audio20.play();
  });
	target20.addEventListener("targetLost", event => {
    audio20.pause()
	});

      });
    </script>
      <style>
      
        body {
    margin: 0;
      font-family: "sofia-pro", Futura, sans-serif;
      }
        #container {
        
    width: 100vw;
    height: 100vh;
    position: relative;
    overflow: hidden;
        }
        #control {
    position: fixed;
    top: 0;
    left: 0;
    z-index: 2;
        }
      .header-box{
        background-position: center;
        background-image: url("/public/MXT_CLM_Kickstarter_Title_SD_04.gif");
        background-size:contain;
        background-repeat: no-repeat;
        width: 75vw;
        height: 100px;
        margin: 20px;
      }
      .canvas{
        display: none;
      }
      .a-canvas{
        z-index: -1;
      }
      .header {
        font-size: 36px;
        font-weight: 700;
      }
      .flex{
        justify-content: center;
        align-items: center;
        display: flex;
        flex-direction: column;
        height: 100vh;
      }
      .button{
        font-size: 36px;
        border: 0px dashed black;
    background-color: white;
    color: black;
    padding: 14px 28px;
    cursor: pointer;
      }
      .button-start{
        font-size: 36px;
        border: 0px dashed black;
    background-color: white;
    color: black;
    padding: 14px 28px;
    cursor: pointer;
      }
      .instructions{
        margin-left: 15px;
        margin-right: 15px;

        text-align: center;
        align-items: center;
        font-size: small;
      }
      .button:hover{
        border-color: orange;
        color: orange;
      }
      
      </style>
  </head>
  <body>
    <div
        class="flex"
        id="header"
        style="display: flex;"
      >
        <div class="header-box"></div>
        <div style="display: flex; flex-direction: column;">
          <div id="instructions" class="instructions">If you are viewing on a mobile device, set silent-mode or vibrate-mode to "off" to hear the read-along.</div>
          <button class="button" id="understandButton">I understand</button>
          <button  class="button-start" id="startButton" style="display: none;">
            Start
          </button>
        </div>
        <div></div>
      </div>
     
    <a-scene renderer="antialias: true;
    colorManagement: false;" mindar-image="autoStart: false; imageTargetSrc: ./targets_full.mind; filterMinCF:0.00025; filterBeta: 0.0008" color-space="sRGB" renderer="colorManagement: true, physicallyCorrectLights" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false">


      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <a-entity id="target0" mindar-image-target="targetIndex: 0">
        <a-entity position="0.55 0 0"
        rotation="90 90 90"
        scale=".51 .5--------------------------1 .51"
        animation-mixer="clip: *;"
        gltf-model="src: url(/public/010.gltf);">
      </a-entity>

    </a-entity>

    <a-entity id="target4" mindar-image-target="targetIndex: 4">
      <a-entity position="0 0 0"
      rotation="90 90 90"
      scale=".8 .8 .8"
      animation-mixer="clip: *;"
      gltf-model="src: url(/public/040.gltf);">
    </a-entity>
  </a-entity>
  
    <a-entity id="target5" mindar-image-target="targetIndex: 5">
      <a-entity position="0 0 0"
      rotation="90 90 90"
      scale="1.7 1.7 1.7"
      animation-mixer="clip: *;"
      gltf-model="src: url(/public/050.gltf);">
    </a-entity>
          
    </a-entity>
                     

        <a-entity id="target6" mindar-image-target="targetIndex: 6">
          <a-entity position="0 0 0"
          rotation="90 90 90"
          scale="1.2 1.2 1.2"
          animation-mixer="clip: *;"
          gltf-model="src: url(/public/060.gltf);">
        </a-entity>
              
        </a-entity>



  <a-entity id="target7" mindar-image-target="targetIndex: 7" >
    <a-entity position="0.25 0 0"
    rotation="160 90 90"
    scale="1.2  1.2 1.2"
    animation-mixer="clip: *;"
    gltf-model="src: url(/public/070.gltf);">
</a-entity>
  
  </a-entity>

<a-entity id="target8" mindar-image-target="targetIndex: 8" >
  <a-entity position="-.07 0.06 0"
    rotation="-45 0 0"
    scale="9 9 9"
    animation-mixer="clip: *;"
    gltf-model="src: url(/public/080.gltf);">
</a-entity>
 

  
</a-entity>



<a-entity id="target9" mindar-image-target="targetIndex: 9">
  <a-entity position="0 0 0"
  rotation="90 90 90"
  scale="1.2 1.2 1.2"
  animation-mixer="clip: *;"
  gltf-model="src: url(/public/090.gltf);">
</a-entity>


</a-entity>

<a-entity id="target10" mindar-image-target="targetIndex: 10">

  <a-entity position="0 0 0"
  rotation="90 90 90"
  scale="30 30 30"
  animation-mixer="clip: *;"
  gltf-model="src: url(/public/100.gltf);">
</a-entity>
</a-entity>


<a-entity id="target11" mindar-image-target="targetIndex: 11">

  
  <a-entity position="-.25 -.10 0"
  rotation="90 90 90"
  scale="20 20 20"
  animation-mixer="clip: *;"
  gltf-model="src: url(/public/110.gltf);">
</a-entity>
</a-entity>

<a-entity id="target12" mindar-image-target="targetIndex: 12">
   
  <a-entity position="0 -.10 0"
  rotation="90 90 90"
  scale="35 35 35"
  animation-mixer="clip: *;"
  gltf-model="src: url(/public/120.gltf);">
</a-entity>
</a-entity>

<a-entity id="target13" mindar-image-target="targetIndex: 13">
  <a-entity position="0 -.10 0"
  rotation="90 90 90"
  scale="30 30 30"
  animation-mixer="clip: *;"
  gltf-model="src: url(/public/130.gltf);">
</a-entity>
  <!-- <a-entity rotation="90 0 0" gltf-model="#8" scale="20 20 20"></a-entity> -->
</a-entity>

<a-entity id="target14" mindar-image-target="targetIndex: 14">
  <a-entity position="0.0 .05 0"
  rotation="90 90 90"
  scale="12 12 12"
  animation-mixer="clip: *;"
  gltf-model="src: url(/public/140.gltf);">
</a-entity>
  <!-- <a-entity rotation="90 0 0" position="-.1 0 0" gltf-model="#9" scale="18 18 18"></a-entity> -->
</a-entity>

<a-entity id="target15" mindar-image-target="targetIndex: 15">
  <a-entity position=".125 -.10 0"
  rotation="57 90 90"
  scale="1 1 1"
  animation-mixer="clip: *;"
  gltf-model="src: url(/public/150.gltf);">
</a-entity>
  <!-- <a-entity rotation="90 0 0" position=".125 -.05 0" gltf-model="#10" scale="15 15 15"></a-entity> -->
</a-entity>

<a-entity id="target16" mindar-image-target="targetIndex: 16">
  <a-entity position="0.25 -.45 0"
  rotation="0 0 0"
  scale="30 30 30"
  animation-mixer="clip: *;"
  gltf-model="src: url(/public/160.gltf);">
</a-entity>
  <!-- <a-entity rotation="90 0 0" gltf-model="#11" scale="35 35 35"></a-entity> -->
</a-entity>

<a-entity id="target17" mindar-image-target="targetIndex: 17">
  <a-entity position="0 0 -.50"
  rotation="90 90 90"
  scale="25 25 25"
  animation-mixer="clip: *;"
  gltf-model="src: url(/public/170.gltf);">
</a-entity>
  <!-- <a-entity rotation="90 0 0"  gltf-model="#12" scale="18 18 18"></a-entity> -->
</a-entity>

<a-entity id="target18" mindar-image-target="targetIndex: 18">
  <a-entity position="0 0 -.20"
  rotation="90 90 90"
  scale="22 22 22"
  animation-mixer="clip: *;"
  gltf-model="src: url(/public/180.gltf);">
</a-entity>
</a-entity>

<a-entity id="target19" mindar-image-target="targetIndex: 19">
  <a-entity position="0 .25 0"
  rotation="90 90 90"
  scale="120 120 120"
  animation-mixer="clip: *;"
  gltf-model="src: url(/public/190.gltf);">
</a-entity>

</a-entity>

<a-entity id="target20" mindar-image-target="targetIndex: 20">
  <a-entity position="0.5 0 0"
  rotation="90 90 90"
  scale=".51 .51 .51"
  animation-mixer="clip: *;"
  gltf-model="src: url(/public/200.gltf);">
</a-entity>

</a-entity>

<a-entity id="target21" mindar-image-target="targetIndex: 21">
  <a-entity position="0 0 0"
  rotation="90 90 90"
  scale="1 1 1"
  animation-mixer="clip: *;"
  gltf-model="src: url(/public/7.gltf);">
</a-entity>

</a-entity>

<a-entity id="target22" mindar-image-target="targetIndex: 22">
  <a-entity position="0 0 0"
  rotation="90 90 90"
  scale="1 1 1"
  animation-mixer="clip: *;"
  gltf-model="src: url(/public/220.gltf);">
</a-entity>

</a-entity>


    </a-scene>

  </body>
</html>